<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/feross/hostile"

    >hostile (v1.3.0)</a>
</h1>
<h4>Simple /etc/hosts manipulation</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.hostile">module hostile</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.hostile.get">
            function <span class="apidocSignatureSpan">hostile.</span>get
            <span class="apidocSignatureSpan">(preserveFormatting, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.hostile.getFile">
            function <span class="apidocSignatureSpan">hostile.</span>getFile
            <span class="apidocSignatureSpan">(filePath, preserveFormatting, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.hostile.remove">
            function <span class="apidocSignatureSpan">hostile.</span>remove
            <span class="apidocSignatureSpan">(ip, host, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.hostile.set">
            function <span class="apidocSignatureSpan">hostile.</span>set
            <span class="apidocSignatureSpan">(ip, host, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.hostile.writeFile">
            function <span class="apidocSignatureSpan">hostile.</span>writeFile
            <span class="apidocSignatureSpan">(lines, cb)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">hostile.</span>HOSTS</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.hostile" id="apidoc.module.hostile">module hostile</a></h1>


    <h2>
        <a href="#apidoc.element.hostile.get" id="apidoc.element.hostile.get">
        function <span class="apidocSignatureSpan">hostile.</span>get
        <span class="apidocSignatureSpan">(preserveFormatting, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (preserveFormatting, cb) {
  return exports.getFile(exports.HOSTS, preserveFormatting, cb)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
#### get all lines in /etc/hosts

```js
// If `preserveFormatting` is true, then include comments, blank lines and other
// non-host entries in the result
var preserveFormatting = false

hostile.<span class="apidocCodeKeywordSpan">get</span>(preserveFormatting, function (err, lines) {
  if (err) {
    console.error(err.message)
  }
  lines.forEach(function (line) {
    console.log(line) // [IP, Host]
  })
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.hostile.getFile" id="apidoc.element.hostile.getFile">
        function <span class="apidocSignatureSpan">hostile.</span>getFile
        <span class="apidocSignatureSpan">(filePath, preserveFormatting, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFile = function (filePath, preserveFormatting, cb) {
  var lines = []
  if (typeof cb !== &#x27;function&#x27;) {
    fs.readFileSync(filePath, { encoding: &#x27;utf8&#x27; }).split(/\r?\n/).forEach(online)
    return lines
  }

  cb = once(cb)
  fs.createReadStream(filePath, { encoding: &#x27;utf8&#x27; })
    .pipe(split())
    .pipe(through(online))
    .on(&#x27;close&#x27;, function () {
      cb(null, lines)
    })
    .on(&#x27;error&#x27;, cb)

  function online (line) {
    // Remove all comment text from the line
    var lineSansComments = line.replace(/#.*/, &#x27;&#x27;)
    var matches = /^\s*?(.+?)\s+(.+?)\s*$/.exec(lineSansComments)
    if (matches &#x26;&#x26; matches.length === 3) {
      // Found a hosts entry
      var ip = matches[1]
      var host = matches[2]
      lines.push([ip, host])
    } else {
      // Found a comment, blank line, or something else
      if (preserveFormatting) {
        lines.push(line)
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
#### get all lines in any file

```js
// If `preserveFormatting` is true, then include comments, blank lines and other
// non-host entries in the result
var preserveFormatting = false

hostile.<span class="apidocCodeKeywordSpan">getFile</span>(file_path, preserveFormatting, function (err, lines) {
  if (err) {
    console.error(err.message)
  }
  lines.forEach(function (line) {
    console.log(line) // [IP, Host]
  })
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.hostile.remove" id="apidoc.element.hostile.remove">
        function <span class="apidocSignatureSpan">hostile.</span>remove
        <span class="apidocSignatureSpan">(ip, host, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remove = function (ip, host, cb) {
  if (typeof cb !== &#x27;function&#x27;) {
    return _remove(exports.get(true))
  }

  exports.get(true, function (err, lines) {
    if (err) return cb(err)
    _remove(lines)
  })

  function _remove (lines) {
    // Try to remove entry, if it exists
    lines = lines.filter(filterFunc)
    return exports.writeFile(lines, cb)
  }

  function filterFunc (line) {
    return !(Array.isArray(line) &#x26;&#x26; line[0] === ip &#x26;&#x26; line[1] === host)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

If the rule already exists, then this does nothing.

#### remove a rule from /etc/hosts

```js
hostile.<span class="apidocCodeKeywordSpan">remove</span>(&#x27;127.0.0.1&#x27;, &#x27;peercdn.com&#x27;, function (err) {
  if (err) {
    console.error(err)
  } else {
    console.log(&#x27;set /etc/hosts successfully!&#x27;)
  }
})
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.hostile.set" id="apidoc.element.hostile.set">
        function <span class="apidocSignatureSpan">hostile.</span>set
        <span class="apidocSignatureSpan">(ip, host, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (ip, host, cb) {
  var didUpdate = false
  if (typeof cb !== &#x27;function&#x27;) {
    return _set(exports.get(true))
  }

  exports.get(true, function (err, lines) {
    if (err) return cb(err)
    _set(lines)
  })

  function _set (lines) {
    // Try to update entry, if host already exists in file
    lines = lines.map(mapFunc)

    // If entry did not exist, let&#x27;s add it
    if (!didUpdate) {
      // If the last line is empty, or just whitespace, then insert the new entry
      // right before it
      var lastLine = lines[lines.length - 1]
      if (typeof lastLine === &#x27;string&#x27; &#x26;&#x26; /\s*/.test(lastLine)) {
        lines.splice(lines.length - 1, 0, [ip, host])
      } else {
        lines.push([ip, host])
      }
    }

    exports.writeFile(lines, cb)
  }

  function mapFunc (line) {
    // replace a line if both hostname and ip version of the address matches
    if (Array.isArray(line) &#x26;&#x26; line[1] === host &#x26;&#x26; net.isIP(line[0]) === net.isIP(ip)) {
      line[0] = ip
      didUpdate = true
    }
    return line
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

**All methods have sync versions. Just omit the callback parameter.**

#### add a rule to /etc/hosts

```js
var hostile = require(&#x27;hostile&#x27;)
hostile.<span class="apidocCodeKeywordSpan">set</span>(&#x27;127.0.0.1&#x27;, &#x27;peercdn.com&#x27;, function (err) {
  if (err) {
    console.error(err)
  } else {
    console.log(&#x27;set /etc/hosts successfully!&#x27;)
  }
})
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.hostile.writeFile" id="apidoc.element.hostile.writeFile">
        function <span class="apidocSignatureSpan">hostile.</span>writeFile
        <span class="apidocSignatureSpan">(lines, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">writeFile = function (lines, cb) {
  lines = lines.map(function (line, lineNum) {
    if (Array.isArray(line)) {
      line = line[0] + &#x27; &#x27; + line[1]
    }
    return line + (lineNum === lines.length - 1 ? &#x27;&#x27; : EOL)
  })

  if (typeof cb !== &#x27;function&#x27;) {
    var stat = fs.statSync(exports.HOSTS)
    fs.writeFileSync(exports.HOSTS, lines.join(&#x27;&#x27;), { mode: stat.mode })
    return true
  }

  cb = once(cb)
  fs.stat(exports.HOSTS, function (err, stat) {
    if (err) {
      return cb(err)
    }
    var s = fs.createWriteStream(exports.HOSTS, { mode: stat.mode })
    s.on(&#x27;close&#x27;, cb)
    s.on(&#x27;error&#x27;, cb)

    lines.forEach(function (data) {
      s.write(data)
    })
    s.end()
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (typeof lastLine === &#x27;string&#x27; &#x26;&#x26; /\s*/.test(lastLine)) {
      lines.splice(lines.length - 1, 0, [ip, host])
    } else {
      lines.push([ip, host])
    }
  }

  exports.<span class="apidocCodeKeywordSpan">writeFile</span>(lines, cb)
}

function mapFunc (line) {
  // replace a line if both hostname and ip version of the address matches
  if (Array.isArray(line) &#x26;&#x26; line[1] === host &#x26;&#x26; net.isIP(line[0]) === net.isIP(ip)) {
    line[0] = ip
    didUpdate = true
...</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
